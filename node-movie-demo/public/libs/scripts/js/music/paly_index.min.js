function $(t){return document.querySelectorAll(t)}function random(t,e){return Math.round(Math.random()*(e-t)+t)}function getDots(){Dots=[];for(var t=0;t<size;t++){var e=random(0,width),i=random(0,height),a="rgba("+random(0,255)+","+random(0,255)+","+random(0,255)+",0)";Dots.push({x:e,y:i,dx:random(1,4),color:a,cap:0})}}function resize(){height=box.clientHeight,width=box.clientWidth,canvas.height=height,canvas.width=width,line=ctx.createLinearGradient(0,0,0,height),line.addColorStop(0,"red"),line.addColorStop(.5,"yellow"),line.addColorStop(1,"green"),getDots()}function draw(t){ctx.clearRect(0,0,width,height);var e=width/size,i=.6*e,a=i>10?10:i;ctx.fillStyle=line;for(var o=0;o<size;o++){var l=Dots[o];if("column"==draw.type){var n=t[o]/256*height;ctx.fillRect(e*o,height-n,i,n),ctx.fillRect(e*o,height-(l.cap+a),i,a),l.cap--,l.cap<0&&(l.cap=0),n>0&&l.cap<n+40&&(l.cap=n+40>height-a?height-a:n+40)}else if("dot"==draw.type){ctx.beginPath();var r=10+t[o]/256*(height>width?width:height)/10;ctx.arc(l.x,l.y,r,0,2*Math.PI,!0);var c=ctx.createRadialGradient(l.x,l.y,0,l.x,l.y,r);c.addColorStop(0,"#fff"),c.addColorStop(1,l.color),ctx.fillStyle=c,ctx.fill(),l.x+=l.dx,l.x=l.x>width?0:l.x}}}var lis=$("#list li"),size=32,line,box=$("#box")[0],height,width,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");box.appendChild(canvas);for(var Dots=[],mv=new MusicVisualizer({size:size,visualizer:draw}),i=0;i<lis.length;i++)lis[i].onclick=function(){for(var t=0;t<lis.length;t++)lis[t].className="";this.className="selected",mv.play("/media/"+this.title)};resize(),window.onresize=resize,draw.type="column";for(var types=$("#type li"),i=0;i<types.length;i++)types[i].onclick=function(){for(var t=0;t<types.length;t++)types[t].className="";this.className="selected01",draw.type=this.getAttribute("data-type")};$("#volume")[0].onchange=function(){mv.changeVolume(this.value/this.max)},$("#volume")[0].onchange;